<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <style media="screen">
        #canvas{
            background:pink;
        }
    </style>
</head>
<body>
    <canvas id="canvas" width="500" height="300"></canvas>
</body>
<script type="text/javascript">
    var str = '[{"name":"1月","value":100},{"name":"2月","value":500},{"name":"3月","value":280},{"name":"4月","value":600},{"name":"5月","value":690}]';
    var arr = JSON.parse(str);
    var canvas = document.querySelector("#canvas");
    var draw = new Draw(arr,canvas,{
        // color:'red',
        // lineWidth:3,
        // xPiex:true,
        // yPiex:true
    });
    draw.drawPiex();
    draw.drawPoint();
    // draw.drawText();

    function Draw(array, canvas, obj) {
        var ctx = canvas.getContext("2d");
        this.ctxWidth = canvas.width;
        this.ctxHeight = canvas.height;
        this.points = [];
        this.length = array.length;

        this.drawPiex = function() {
            ctx.beginPath();
            ctx.moveTo(50, 50);
            ctx.lineTo(50, this.ctxHeight - 50);
            ctx.lineTo(this.ctxWidth - 50, this.ctxHeight - 50);
            ctx.moveTo(40, 60);
            ctx.lineTo(50, 50);
            ctx.lineTo(60, 60);
            ctx.moveTo(this.ctxWidth - 60, this.ctxHeight - 60);
            ctx.lineTo(this.ctxWidth - 50, this.ctxHeight - 50);
            ctx.lineTo(this.ctxWidth - 60, this.ctxHeight - 40);
            ctx.stroke();
            ctx.closePath();
        }
        this.drawPoint = function() {
            var length = array.length;
            var x_dis = this.ctxWidth - 100 - 50;
            var per_disX = x_dis / length;
            var y_dis = this.ctxHeight - 150;
            var scale = y_dis / this.getMaxY();
            for (var i = 0; i < array.length; i++) {
                var x = (i + 1) * per_disX + 50;
                var y = this.ctxHeight - scale * array[i].value - 50;
                var p = new Point(x, y);
                this.points.push(p);
                ctx.font = '20px FangSong';
                ctx.fillText(array[i].name,x-10,270);
                ctx.fillText(array[i].value,15,y+5);
            }
            this.beginDrawPoint();
        }
        this.beginDrawPoint = function() {
            ctx.beginPath();
            ctx.moveTo(this.points[0].x, this.points[0].y);
            for (var i = 1; i < this.points.length; i++) {
                ctx.lineTo(this.points[i].x, this.points[i].y);
            }
            ctx.strokeStyle = obj.color;
            ctx.lineWidth = obj.lineWidth;
            ctx.stroke();
            ctx.closePath();
        }
        this.getMaxY = function() {
            var max = 0;
            for (var i = 0; i < array.length; i++) {
                if (array[i].value > max) {
                    max = array[i].value;
                }
            }
            return max;
        }
    }

    function Point(x, y) {
        this.x = x;
        this.y = y;
    }

</script>

</html>
