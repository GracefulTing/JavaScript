<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>图片延时加载</title>
	<style>
		*{
			margin:0;
			padding: 0;
		}
		ul{
			list-style: none;
			width:500px;
			margin:0 auto;
		}
		ul li{
			position: relative;
			width:100%;
			height:1000px;
		}
		ul li img{
			position: absolute;
			bottom:0;
			width:500px;
			height:500px;
		}
	</style>
</head>
<body>
	<ul>
		<li>
			<img src="images/1.jpg" alt="">
		</li>
		<li>
			<img src="images/2.jpg" alt="">
		</li>
		<li>
			<img src="images/3.jpg" alt="">
		</li>
		<li>
			<img src="images/4.jpg" alt="">
		</li>
	</ul>
	<script>
		var imgs=document.getElementsByTagName('img');
		//可视区高度
		var bodyHeight=document.documentElement.clientHeight;
		//滚动高度       
		var bodyScroll=document.body.scrollTop||document.documentElement.scrollTop; 

		for(var i=0;i<imgs.length;i++){
			var srcVal=imgs[i].getAttribute("src");
			imgs[i].setAttribute("_src",srcVal);
			imgs[i].setAttribute("src"," ");

		//	console.log(imgs[i].offsetTop);
		//	console.log(imgs[0].offsetParent.offsetParent);
			//offsetTop是指该元素到他的第一个有定位属性的父级的顶端距离,如果他的每一层父级都没有定位,那么获取到body的距离.
			//offsetParent获取该元素的第一个有定位属性的父级,如果他的每一层父级都没有定位,那么获取body标签.

			//当条件成立时,说明该img标签已经进入可视区.
			if(getTop(imgs[i])<=bodyHeight+bodyScroll){
				imgs[i].src=imgs[i].getAttribute("_src");
			}
			// console.log(getTop(imgs[i]));
			// console.log(bodyHeight,bodyScroll);
		}

		//绑定滚动事件
		window.onscroll=function(){
			//获取当前滚动高度
			var bodyScroll=document.body.scrollTop||document.documentElement.scrollTop; 
			for(var i=0;i<imgs.length;i++){
				if(getTop(imgs[i])<=bodyHeight+bodyScroll){
					imgs[i].src=imgs[i].getAttribute("_src");
				}
			}
		}

		//获取绝对offsetTop
		function getTop(obj){
			var iTop=0;
			while(obj){
				iTop+=obj.offsetTop;
				obj=obj.offsetParent;
			}
			return iTop;
		}

	</script>
</body>
</html>