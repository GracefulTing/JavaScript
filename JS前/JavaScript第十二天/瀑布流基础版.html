<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>瀑布流基础版</title>
	<style>
		*{
			margin:0;
			padding:0;
		}
		.warp{
			width:600px;
			margin:0 auto;
			padding: 20px 10px;
			border:1px solid #999;
			overflow: hidden;
		}
		.warp ul{
			float:left;
			width:200px;
			list-style: none;
			padding: 0 10px;
			box-sizing: border-box;  
			/*代表此元素的内边距和边框不会增加它的宽度*/
		}
		.warp ul li{
			background:red;
			margin-bottom:20px;
			font-size:50px;
		}
	</style>
</head>
<body>
	<div class="warp" id="warp">
		<ul></ul>
		<ul></ul>
		<ul></ul>
	</div>
	<script>
		var warp=document.getElementById('warp');
		var list=document.getElementsByTagName('ul');

		//随机函数用于设定单个元素高度
		function randFn(min,max){
			var rand=parseInt(Math.random()*(max-min))+min;
			return rand;
		}

		createLi();
		//创建li元素
		function createLi(){
			for(var i=0;i<10;i++){       //控制li的个数
				var li=document.createElement('li');
				var height=randFn(100,300);
				li.innerHTML=i;
				li.style.height=height+"px";
				var heightArr=[];
				var minIndex=0;
				for(var j=0;j<list.length;j++){
					heightArr.push(list[j].offsetHeight);
					var minHeight=heightArr[minIndex];   //先假设数组中的第一项最小
					if(minHeight>heightArr[j]){
						//与数组里的每一项进行比较,把最终的最小项赋给minHeight.
						minHeight=heightArr[j];
						//获取了最小项的索引.
						minIndex=j;
					}
					// list[minIndex].appendChild(li);
					//将li优先插入高度最小的ul中.目的在于平衡每个ul.
				}
				list[minIndex].appendChild(li);
			}
		}


		//滚动事件
		window.onscroll=function(){
			var windowHeight=document.documentElement.clientHeight;   //可视区高度
			var bodyHeight=document.documentElement.offsetHeight;      //内容高度
			var scrollHeight=bodyHeight-windowHeight;   //滚动最大高度
			var scrollTop=document.body.scrollTop||document.documentElement.scrollTop;
			if(scrollTop>=scrollHeight){
				createLi();
			}
		}
	</script>
</body>
</html>